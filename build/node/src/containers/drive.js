"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.Drive = void 0;
var Meta = _interopRequireWildcard(require("@dashkite/joy/metaclass"));
var Type = _interopRequireWildcard(require("@dashkite/joy/type"));
var _generic = require("@dashkite/joy/generic");
var _graph = require("./graph.js");
var _talos = require("./talos.js");
function _getRequireWildcardCache(e) { if ("function" != typeof WeakMap) return null; var r = new WeakMap(), t = new WeakMap(); return (_getRequireWildcardCache = function (e) { return e ? t : r; })(e); }
function _interopRequireWildcard(e, r) { if (!r && e && e.__esModule) return e; if (null === e || "object" != typeof e && "function" != typeof e) return { default: e }; var t = _getRequireWildcardCache(r); if (t && t.has(e)) return t.get(e); var n = { __proto__: null }, a = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var u in e) if ("default" !== u && Object.prototype.hasOwnProperty.call(e, u)) { var i = a ? Object.getOwnPropertyDescriptor(e, u) : null; i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u]; } return n.default = e, t && t.set(e, n), n; }
var Drive, make;
make = (0, _generic.generic)({
  name: "drive make",
  default: function (...args) {
    throw new Error(`Drive.make: input is malformed ${JSON.stringify(args)}`);
  }
});
(0, _generic.generic)(make, _graph.Graph.isType, _talos.Talos.isType, Type.isFunction, function (graph, talos, step) {
  return new Drive({
    graph,
    talos,
    step
  });
});
exports.Drive = Drive = function () {
  class Drive {
    constructor({
      graph: graph1,
      talos: talos1,
      step: step1
    }) {
      this.graph = graph1;
      this.talos = talos1;
      this.step = step1;
    }
    update(transform) {
      return this.step(this.graph, this.talos, transform);
    }
  }
  ;
  Meta.mixin(Drive.prototype, [Meta.getters({
    state: function () {
      return this.talos.state;
    },
    isSync: function () {
      return Type.isRegularFunction(this.step);
    }
  })]);
  Drive.make = make;
  Drive.isType = Type.isType(Drive);
  return Drive;
}.call(void 0);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9jb250YWluZXJzL2RyaXZlLmNvZmZlZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBLElBQUEsR0FBQSx1QkFBQSxDQUFBLE9BQUE7QUFDQSxJQUFBLElBQUEsR0FBQSx1QkFBQSxDQUFBLE9BQUE7QUFDQSxJQUFBLFFBQUEsR0FBQSxPQUFBO0FBQUEsSUFBQSxNQUFBLEdBQUEsT0FBQTtBQUFBLElBQUEsTUFBQSxHQUFBLE9BQUE7QUFBQSxTQUFBLHlCQUFBLENBQUEsNkJBQUEsT0FBQSxtQkFBQSxDQUFBLE9BQUEsT0FBQSxJQUFBLENBQUEsT0FBQSxPQUFBLFlBQUEsd0JBQUEsWUFBQSxDQUFBLENBQUEsV0FBQSxDQUFBLEdBQUEsQ0FBQSxHQUFBLENBQUEsS0FBQSxDQUFBO0FBQUEsU0FBQSx3QkFBQSxDQUFBLEVBQUEsQ0FBQSxTQUFBLENBQUEsSUFBQSxDQUFBLElBQUEsQ0FBQSxDQUFBLFVBQUEsU0FBQSxDQUFBLGVBQUEsQ0FBQSx1QkFBQSxDQUFBLHlCQUFBLENBQUEsV0FBQSxPQUFBLEVBQUEsQ0FBQSxRQUFBLENBQUEsR0FBQSx3QkFBQSxDQUFBLENBQUEsT0FBQSxDQUFBLElBQUEsQ0FBQSxDQUFBLEdBQUEsQ0FBQSxDQUFBLFVBQUEsQ0FBQSxDQUFBLEdBQUEsQ0FBQSxDQUFBLE9BQUEsQ0FBQSxLQUFBLFNBQUEsVUFBQSxDQUFBLEdBQUEsTUFBQSxDQUFBLGNBQUEsSUFBQSxNQUFBLENBQUEsd0JBQUEsV0FBQSxDQUFBLElBQUEsQ0FBQSxvQkFBQSxDQUFBLElBQUEsTUFBQSxDQUFBLFNBQUEsQ0FBQSxjQUFBLENBQUEsSUFBQSxDQUFBLENBQUEsRUFBQSxDQUFBLFNBQUEsQ0FBQSxHQUFBLENBQUEsR0FBQSxNQUFBLENBQUEsd0JBQUEsQ0FBQSxDQUFBLEVBQUEsQ0FBQSxVQUFBLENBQUEsS0FBQSxDQUFBLENBQUEsR0FBQSxJQUFBLENBQUEsQ0FBQSxHQUFBLElBQUEsTUFBQSxDQUFBLGNBQUEsQ0FBQSxDQUFBLEVBQUEsQ0FBQSxFQUFBLENBQUEsSUFBQSxDQUFBLENBQUEsQ0FBQSxJQUFBLENBQUEsQ0FBQSxDQUFBLFlBQUEsQ0FBQSxDQUFBLE9BQUEsR0FBQSxDQUFBLEVBQUEsQ0FBQSxJQUFBLENBQUEsQ0FBQSxHQUFBLENBQUEsQ0FBQSxFQUFBLENBQUEsR0FBQSxDQUFBO0FBRkEsSUFBQSxLQUFBLEVBQUEsSUFBQTtBQU9BLElBQUEsR0FBTyxJQUFBLGdCQUFBLEVBQ0w7RUFBQSxJQUFBLEVBQU0sWUFBTjtFQUNBLE9BQUEsRUFBUyxTQUFBLENBQUEsR0FBRSxJQUFGLEVBQUE7SUFDUCxNQUFNLElBQUksS0FBSixDQUFVLGtDQUFrQyxJQUFJLENBQUMsU0FBTCxDQUFlLElBQWpELENBQUEsRUFBVixDQUFBO0VBREM7QUFEVCxDQURLLENBQUE7QUFLUCxJQUFBLGdCQUFBLEVBQVEsSUFBUixFQUFjLFlBQUssQ0FBQyxNQUFwQixFQUE0QixZQUFLLENBQUMsTUFBbEMsRUFBMEMsSUFBSSxDQUFDLFVBQS9DLEVBQTRELFVBQUUsS0FBRixFQUFTLEtBQVQsRUFBZ0IsSUFBaEIsRUFBQTtTQUMxRCxJQUFJLEtBQUosQ0FBVTtJQUFFLEtBQUY7SUFBUyxLQUFUO0lBQWdCO0VBQWhCLENBQVYsQ0FBQTtBQUQwRCxDQUE1RCxDQUFBO0FBSU0sT0FBQSxDQUFBLEtBQUEsR0FBQSxLQUFBLEdBQUEsWUFBQTtFQUFOLE1BQUEsS0FBQSxDQUFBO0lBQ0UsV0FBYSxDQUFDO01BQUcsS0FBQSxFQUFBLE1BQUg7TUFBVyxLQUFBLEVBQUEsTUFBWDtNQUFtQixJQUFBLEVBQUE7SUFBbkIsQ0FBRCxFQUFBO01BQUcsSUFBQyxDQUFBLEtBQUEsR0FBQSxNQUFBO01BQU8sSUFBQyxDQUFBLEtBQUEsR0FBQSxNQUFBO01BQU8sSUFBQyxDQUFBLElBQUEsR0FBQSxLQUFBO0lBQXBCO0lBV2IsTUFBUSxDQUFFLFNBQUYsRUFBQTthQUNOLElBQUMsQ0FBQSxJQUFELENBQU0sSUFBQyxDQUFBLEtBQVAsRUFBYyxJQUFDLENBQUEsS0FBZixFQUFzQixTQUF0QixDQUFBO0lBRE07RUFaVjtFQUFBO0VBR0UsSUFBSSxDQUFDLEtBQUwsQ0FBVyxLQUFDLENBQUEsU0FBWixFQUFnQixDQUNkLElBQUksQ0FBQyxPQUFMLENBQ0U7SUFBQSxLQUFBLEVBQU8sU0FBQSxDQUFBLEVBQUE7YUFBRyxJQUFDLENBQUEsS0FBSyxDQUFDLEtBQUE7SUFBVixDQUFQO0lBQ0EsTUFBQSxFQUFRLFNBQUEsQ0FBQSxFQUFBO2FBQUcsSUFBSSxDQUFDLGlCQUFMLENBQXVCLElBQUMsQ0FBQSxJQUF4QixDQUFBO0lBQUg7RUFEUixDQURGLENBRGMsQ0FBaEIsQ0FBQTtFQU1BLEtBQUMsQ0FBQSxJQUFELEdBQU8sSUFBQTtFQUNQLEtBQUMsQ0FBQSxNQUFELEdBQVMsSUFBSSxDQUFDLE1BQUwsQ0FBWSxLQUFaLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBNZXRhIGZyb20gXCJAZGFzaGtpdGUvam95L21ldGFjbGFzc1wiXG5pbXBvcnQgKiBhcyBUeXBlIGZyb20gXCJAZGFzaGtpdGUvam95L3R5cGVcIlxuaW1wb3J0IHsgZ2VuZXJpYyB9IGZyb20gXCJAZGFzaGtpdGUvam95L2dlbmVyaWNcIlxuaW1wb3J0IHsgR3JhcGggfSBmcm9tIFwiLi9ncmFwaFwiXG5pbXBvcnQgeyBUYWxvcyB9IGZyb20gXCIuL3RhbG9zXCJcblxuXG5tYWtlID0gZ2VuZXJpYyBcbiAgbmFtZTogXCJkcml2ZSBtYWtlXCJcbiAgZGVmYXVsdDogKCBhcmdzLi4uICkgLT4gXG4gICAgdGhyb3cgbmV3IEVycm9yIFwiRHJpdmUubWFrZTogaW5wdXQgaXMgbWFsZm9ybWVkICN7SlNPTi5zdHJpbmdpZnkgYXJnc31cIlxuXG5nZW5lcmljIG1ha2UsIEdyYXBoLmlzVHlwZSwgVGFsb3MuaXNUeXBlLCBUeXBlLmlzRnVuY3Rpb24sICAoIGdyYXBoLCB0YWxvcywgc3RlcCApIC0+XG4gIG5ldyBEcml2ZSB7IGdyYXBoLCB0YWxvcywgc3RlcCB9XG5cblxuY2xhc3MgRHJpdmVcbiAgY29uc3RydWN0b3I6ICh7IEBncmFwaCwgQHRhbG9zLCBAc3RlcCB9KSAtPlxuXG4gIE1ldGEubWl4aW4gQDo6LCBbXG4gICAgTWV0YS5nZXR0ZXJzXG4gICAgICBzdGF0ZTogLT4gQHRhbG9zLnN0YXRlXG4gICAgICBpc1N5bmM6IC0+IFR5cGUuaXNSZWd1bGFyRnVuY3Rpb24gQHN0ZXBcbiAgXVxuXG4gIEBtYWtlOiBtYWtlXG4gIEBpc1R5cGU6IFR5cGUuaXNUeXBlIEBcblxuICB1cGRhdGU6ICggdHJhbnNmb3JtICkgLT5cbiAgICBAc3RlcCBAZ3JhcGgsIEB0YWxvcywgdHJhbnNmb3JtXG5cblxuZXhwb3J0IHtcbiAgRHJpdmVcbn0iXSwic291cmNlUm9vdCI6IiJ9
//# sourceURL=src/containers/drive.coffee