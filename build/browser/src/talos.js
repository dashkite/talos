var Talos;
import * as Meta from "@dashkite/joy/metaclass";
import * as Type from "@dashkite/joy/type";
import { Machine } from "./machine";
import { $start, $end, atStart, atEnd } from "./states";
Talos = (function() {
    class Talos {
        constructor({ machine: machine1 }){
            this.machine = machine1;
            this.state = $start;
            this.context = {};
            this.error = null;
        }
        static make(_machine) {
            var machine;
            machine = Machine.clone(_machine);
            return new Talos({
                machine
            });
        }
        end() {
            return this.state = $end;
        }
        catch(error) {
            this.end();
            return this.error = error;
        }
    }
    ;
    Meta.mixin(Talos.prototype, [
        Meta.getters({
            ended: function() {
                return atEnd(this.state);
            },
            success: function() {
                return this.ended && this.error == null;
            },
            failure: function() {
                return this.ended && this.error != null;
            },
            running: function() {
                return !this.ended;
            }
        })
    ]);
    Talos.isType = Type.isType(Talos);
    return Talos;
}).call(this);
export { Talos }; //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsic3JjL3RhbG9zLmNvZmZlZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxJQUFBOztBQUFBLE9BQU8sQ0FBQSxRQUFQLE1BQUE7O0FBQ0EsT0FBTyxDQUFBLFFBQVAsTUFBQTs7QUFDQSxPQUFBO0VBQVMsT0FBVDtDQUFBLE1BQUE7O0FBQ0EsT0FBQTtFQUFTLE1BQVQ7RUFBaUIsSUFBakI7RUFBdUIsT0FBdkI7RUFBZ0MsS0FBaEM7Q0FBQSxNQUFBOztBQUdNO0VBQU4sTUFBQSxNQUFBO0lBQ0UsV0FBYSxDQUFDO1FBQUc7TUFBSCxDQUFELENBQUE7TUFBRyxJQUFDLENBQUE7TUFDZixJQUFDLENBQUEsS0FBRCxHQUFTO01BQ1QsSUFBQyxDQUFBLE9BQUQsR0FBVyxDQUFBO01BQ1gsSUFBQyxDQUFBLEtBQUQsR0FBUztJQUhFOztJQWFOLE9BQU4sSUFBTSxDQUFFLFFBQUYsQ0FBQTtBQUNULFVBQUE7TUFBSSxPQUFBLEdBQVUsT0FBTyxDQUFDLEtBQVIsQ0FBYyxRQUFkO2FBQ1YsSUFBSSxLQUFKLENBQVUsQ0FBRSxPQUFGLENBQVY7SUFGSzs7SUFNUCxHQUFLLENBQUEsQ0FBQTthQUNILElBQUMsQ0FBQSxLQUFELEdBQVM7SUFETjs7SUFHTCxLQUFPLENBQUUsS0FBRixDQUFBO01BQ0wsSUFBQyxDQUFBLEdBQUQsQ0FBQTthQUNBLElBQUMsQ0FBQSxLQUFELEdBQVM7SUFGSjs7RUF2QlQ7O0VBTUUsSUFBSSxDQUFDLEtBQUwsQ0FBVyxLQUFDLENBQUEsU0FBWixFQUFnQjtJQUNkLElBQUksQ0FBQyxPQUFMLENBQ0U7TUFBQSxLQUFBLEVBQU8sUUFBQSxDQUFBLENBQUE7ZUFBRyxLQUFBLENBQU0sSUFBQyxDQUFBLEtBQVA7TUFBSCxDQUFQO01BQ0EsT0FBQSxFQUFTLFFBQUEsQ0FBQSxDQUFBO2VBQUcsSUFBQyxDQUFBLEtBQUQsSUFBVztNQUFkLENBRFQ7TUFFQSxPQUFBLEVBQVMsUUFBQSxDQUFBLENBQUE7ZUFBRyxJQUFDLENBQUEsS0FBRCxJQUFVO01BQWIsQ0FGVDtNQUdBLE9BQUEsRUFBUyxRQUFBLENBQUEsQ0FBQTtlQUFHLENBQUMsSUFBQyxDQUFBO01BQUw7SUFIVCxDQURGLENBRGM7R0FBaEI7O0VBWUEsS0FBQyxDQUFBLE1BQUQsR0FBUyxJQUFJLENBQUMsTUFBTCxDQUFZLEtBQVo7Ozs7OztBQVVYLE9BQUE7RUFDRSxLQURGIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgTWV0YSBmcm9tIFwiQGRhc2hraXRlL2pveS9tZXRhY2xhc3NcIlxuaW1wb3J0ICogYXMgVHlwZSBmcm9tIFwiQGRhc2hraXRlL2pveS90eXBlXCJcbmltcG9ydCB7IE1hY2hpbmUgfSBmcm9tIFwiLi9tYWNoaW5lXCJcbmltcG9ydCB7ICRzdGFydCwgJGVuZCwgYXRTdGFydCwgYXRFbmQgfSBmcm9tIFwiLi9zdGF0ZXNcIlxuXG5cbmNsYXNzIFRhbG9zXG4gIGNvbnN0cnVjdG9yOiAoeyBAbWFjaGluZSB9KSAtPlxuICAgIEBzdGF0ZSA9ICRzdGFydFxuICAgIEBjb250ZXh0ID0ge31cbiAgICBAZXJyb3IgPSBudWxsXG5cbiAgTWV0YS5taXhpbiBAOjosIFtcbiAgICBNZXRhLmdldHRlcnNcbiAgICAgIGVuZGVkOiAtPiBhdEVuZCBAc3RhdGVcbiAgICAgIHN1Y2Nlc3M6IC0+IEBlbmRlZCAmJiAhQGVycm9yP1xuICAgICAgZmFpbHVyZTogLT4gQGVuZGVkICYmIEBlcnJvcj9cbiAgICAgIHJ1bm5pbmc6IC0+ICFAZW5kZWRcbiAgXVxuXG4gIEBtYWtlOiAoIF9tYWNoaW5lICkgLT4gXG4gICAgbWFjaGluZSA9IE1hY2hpbmUuY2xvbmUgX21hY2hpbmVcbiAgICBuZXcgVGFsb3MgeyBtYWNoaW5lIH1cbiAgXG4gIEBpc1R5cGU6IFR5cGUuaXNUeXBlIEBcblxuICBlbmQ6IC0+XG4gICAgQHN0YXRlID0gJGVuZFxuXG4gIGNhdGNoOiAoIGVycm9yICkgLT5cbiAgICBAZW5kKClcbiAgICBAZXJyb3IgPSBlcnJvclxuXG5cbmV4cG9ydCB7XG4gIFRhbG9zXG59Il19
 //# sourceURL=src/talos.coffee

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy90YWxvcy5jb2ZmZWUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgTWV0YSBmcm9tIFwiQGRhc2hraXRlL2pveS9tZXRhY2xhc3NcIlxuaW1wb3J0ICogYXMgVHlwZSBmcm9tIFwiQGRhc2hraXRlL2pveS90eXBlXCJcbmltcG9ydCB7IE1hY2hpbmUgfSBmcm9tIFwiLi9tYWNoaW5lXCJcbmltcG9ydCB7ICRzdGFydCwgJGVuZCwgYXRTdGFydCwgYXRFbmQgfSBmcm9tIFwiLi9zdGF0ZXNcIlxuXG5cbmNsYXNzIFRhbG9zXG4gIGNvbnN0cnVjdG9yOiAoeyBAbWFjaGluZSB9KSAtPlxuICAgIEBzdGF0ZSA9ICRzdGFydFxuICAgIEBjb250ZXh0ID0ge31cbiAgICBAZXJyb3IgPSBudWxsXG5cbiAgTWV0YS5taXhpbiBAOjosIFtcbiAgICBNZXRhLmdldHRlcnNcbiAgICAgIGVuZGVkOiAtPiBhdEVuZCBAc3RhdGVcbiAgICAgIHN1Y2Nlc3M6IC0+IEBlbmRlZCAmJiAhQGVycm9yP1xuICAgICAgZmFpbHVyZTogLT4gQGVuZGVkICYmIEBlcnJvcj9cbiAgICAgIHJ1bm5pbmc6IC0+ICFAZW5kZWRcbiAgXVxuXG4gIEBtYWtlOiAoIF9tYWNoaW5lICkgLT4gXG4gICAgbWFjaGluZSA9IE1hY2hpbmUuY2xvbmUgX21hY2hpbmVcbiAgICBuZXcgVGFsb3MgeyBtYWNoaW5lIH1cbiAgXG4gIEBpc1R5cGU6IFR5cGUuaXNUeXBlIEBcblxuICBlbmQ6IC0+XG4gICAgQHN0YXRlID0gJGVuZFxuXG4gIGNhdGNoOiAoIGVycm9yICkgLT5cbiAgICBAZW5kKClcbiAgICBAZXJyb3IgPSBlcnJvclxuXG5cbmV4cG9ydCB7XG4gIFRhbG9zXG59Il0sIm5hbWVzIjpbIlRhbG9zIiwiTWV0YSIsIlR5cGUiLCJNYWNoaW5lIiwiJHN0YXJ0IiwiJGVuZCIsImF0U3RhcnQiLCJhdEVuZCIsImNvbnN0cnVjdG9yIiwibWFjaGluZSIsIm1hY2hpbmUxIiwic3RhdGUiLCJjb250ZXh0IiwiZXJyb3IiLCJtYWtlIiwiX21hY2hpbmUiLCJjbG9uZSIsImVuZCIsImNhdGNoIiwibWl4aW4iLCJwcm90b3R5cGUiLCJnZXR0ZXJzIiwiZW5kZWQiLCJzdWNjZXNzIiwiZmFpbHVyZSIsInJ1bm5pbmciLCJpc1R5cGUiXSwibWFwcGluZ3MiOiJBQUFBLElBQUFBO0FBQUEsWUFBT0MsVUFBUCwwQkFBQTtBQUNBLFlBQU9DLFVBQVAscUJBQUE7QUFDQSxTQUFTQyxPQUFULFFBQUEsWUFBQTtBQUNBLFNBQVNDLE1BQVQsRUFBaUJDLElBQWpCLEVBQXVCQyxPQUF2QixFQUFnQ0MsS0FBaEMsUUFBQSxXQUFBO0FBR01QLFFBQUEsQ0FBQTtJQUFOLE1BQUFBO1FBQ0VRLFlBQWMsRUFBR0MsU0FBQUMsUUFBQSxFQUFKLENBQUE7WUFBRyxJQUFDLENBQUFELE9BQUEsR0FBQUM7WUFDZixJQUFDLENBQUFDLEtBQUQsR0FBU1A7WUFDVCxJQUFDLENBQUFRLE9BQUQsR0FBVyxDQUFBO1lBQ1gsSUFBQyxDQUFBQyxLQUFELEdBQVM7UUFIRTtRQWFOLE9BQU5DLEtBQVFDLFFBQUYsRUFBQTtZQUNULElBQUFOO1lBQUlBLFVBQVVOLFFBQVFhLEtBQVIsQ0FBY0Q7bUJBQ3hCLElBQUlmLE1BQU07Z0JBQUVTO1lBQUY7UUFGTDtRQU1QUSxNQUFLO21CQUNILElBQUMsQ0FBQU4sS0FBRCxHQUFTTjtRQUROO1FBR0xhLE1BQVNMLEtBQUYsRUFBQTtZQUNMLElBQUMsQ0FBQUksR0FBRDttQkFDQSxJQUFDLENBQUFKLEtBQUQsR0FBU0E7UUFGSjtJQXZCVDs7SUFNRVosS0FBS2tCLEtBQUwsQ0FBV25CLE1BQUNvQixTQUFaLEVBQWdCO1FBQ2RuQixLQUFLb0IsT0FBTCxDQUNFO1lBQUFDLE9BQU87dUJBQUdmLE1BQU0sSUFBQyxDQUFBSSxLQUFQO1lBQUg7WUFDUFksU0FBUzt1QkFBRyxJQUFDLENBQUFELEtBQUQsSUFBVyxJQUFBLENBQUFULEtBQUEsSUFBQTtZQUFkO1lBQ1RXLFNBQVM7dUJBQUcsSUFBQyxDQUFBRixLQUFELElBQVUsSUFBQSxDQUFBVCxLQUFBLElBQUE7WUFBYjtZQUNUWSxTQUFTO3VCQUFHLENBQUMsSUFBQyxDQUFBSCxLQUFBO1lBQUw7UUFIVDtLQUZKO0lBWUF0QixNQUFDMEIsTUFBRCxHQUFTeEIsS0FBS3dCLE1BQUwsQ0FBWTFCOzs7QUFVdkIsU0FDRUEsS0FERiJ9