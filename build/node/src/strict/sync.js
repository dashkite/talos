"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.step = exports.debug = void 0;
var Type = _interopRequireWildcard(require("@dashkite/joy/type"));
var _predicate = require("@dashkite/joy/predicate");
var _generic = require("@dashkite/joy/generic");
var _index = require("../containers/index.js");
var Errors = _interopRequireWildcard(require("../containers/errors.js"));
function _getRequireWildcardCache(e) { if ("function" != typeof WeakMap) return null; var r = new WeakMap(), t = new WeakMap(); return (_getRequireWildcardCache = function (e) { return e ? t : r; })(e); }
function _interopRequireWildcard(e, r) { if (!r && e && e.__esModule) return e; if (null === e || "object" != typeof e && "function" != typeof e) return { default: e }; var t = _getRequireWildcardCache(r); if (t && t.has(e)) return t.get(e); var n = { __proto__: null }, a = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var u in e) if ("default" !== u && Object.prototype.hasOwnProperty.call(e, u)) { var i = a ? Object.getOwnPropertyDescriptor(e, u) : null; i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u]; } return n.default = e, t && t.set(e, n), n; }
var _debug, _step, debug, matchEdge, matchVertex, move, run, step;
matchVertex = function (graph, talos) {
  var vertex;
  vertex = graph.get(talos);
  if (vertex == null) {
    talos.throw(Errors.InvalidState.create("talos state is not in graph"));
  }
  return vertex;
};
matchEdge = function (vertex, talos, transform) {
  var edge, i, len, ref;
  ref = vertex.edges;
  for (i = 0, len = ref.length; i < len; i++) {
    edge = ref[i];
    if (edge.accept(talos, transform) === true) {
      return edge;
    }
  }
  return talos.throw(Errors.MissingTransition.create("no edge matches transform"));
};
run = function (edge, talos, transform) {
  var error;
  if (edge.run != null) {
    try {
      return edge.run(talos, transform);
    } catch (error1) {
      error = error1;
      return talos.throw(Errors.FailedRun.create(error, "encountered an error while running edge function"));
    }
  }
};
move = function (edge, talos, transform) {
  var error;
  try {
    return edge.move(talos, transform);
  } catch (error1) {
    error = error1;
    return talos.throw(Errors.FailedMove.create(error, "encountered an error while moving states"));
  }
};
exports.step = step = (0, _generic.generic)({
  name: "step talos",
  default: function (...args) {
    throw new Error(`step: input is malformed ${JSON.stringify(args)}`);
  }
});
(0, _generic.generic)(step, _index.Graph.isType, _index.Talos.isType, Type.isAny, function (graph, talos, transform) {
  return _step(graph, talos, transform);
});
(0, _generic.generic)(step, _index.Graph.isType, (0, _predicate.negate)(_index.Talos.isType), function (graph, transform) {
  return step(graph, _index.Talos.create(), transform);
});
_step = function (graph, talos, transform) {
  var edge, vertex;
  vertex = matchVertex(graph, talos);
  if (talos.halted) {
    return talos;
  }
  edge = matchEdge(vertex, talos, transform);
  if (talos.halted) {
    return talos;
  }
  run(edge, talos, transform);
  if (talos.halted) {
    return talos;
  }
  move(edge, talos, transform);
  return talos;
};
exports.debug = debug = (0, _generic.generic)({
  name: "debug step talos",
  default: function (...args) {
    throw new Error(`debug step: input is malformed ${JSON.stringify(args)}`);
  }
});
(0, _generic.generic)(debug, _index.Graph.isType, _index.Talos.isType, Type.isAny, function (graph, talos, transform) {
  return _debug(graph, talos, transform);
});
(0, _generic.generic)(debug, _index.Graph.isType, (0, _predicate.negate)(_index.Talos.isType), function (graph, transform) {
  return _debug(graph, _index.Talos.create(), transform);
});
_debug = function (graph, talos, transform) {
  var edge, vertex;
  console.log("starting step", {
    graph,
    talos,
    transform
  });
  vertex = matchVertex(graph, talos);
  if (talos.halted) {
    console.error("encountered error matching vertex", talos.error.error, talos);
    return talos;
  } else {
    console.log("vertex matched", {
      vertex,
      talos
    });
  }
  edge = matchEdge(vertex, talos, transform);
  if (talos.halted) {
    console.error("encountered error matching edge", talos.error.error, talos);
    return talos;
  } else {
    console.log("edge matched", {
      edge,
      talos
    });
  }
  run(edge, talos, transform);
  if (talos.halted) {
    console.error("encountered error running edge function", talos.error.error, talos);
    return talos;
  } else {
    console.log("edge function complete", {
      talos
    });
  }
  move(edge, talos, transform);
  if (talos.halted) {
    console.error("encountered error running move function", talos.error.error, talos);
    return talos;
  } else {
    console.log("talos move complete", {
      talos
    });
  }
  return talos;
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9zdHJpY3Qvc3luYy5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQSxJQUFBLEdBQUEsdUJBQUEsQ0FBQSxPQUFBO0FBQ0EsSUFBQSxVQUFBLEdBQUEsT0FBQTtBQUNBLElBQUEsUUFBQSxHQUFBLE9BQUE7QUFBQSxJQUFBLE1BQUEsR0FBQSxPQUFBO0FBQUEsSUFBQSxNQUFBLEdBQUEsdUJBQUEsQ0FBQSxPQUFBO0FBQUEsU0FBQSx5QkFBQSxDQUFBLDZCQUFBLE9BQUEsbUJBQUEsQ0FBQSxPQUFBLE9BQUEsSUFBQSxDQUFBLE9BQUEsT0FBQSxZQUFBLHdCQUFBLFlBQUEsQ0FBQSxDQUFBLFdBQUEsQ0FBQSxHQUFBLENBQUEsR0FBQSxDQUFBLEtBQUEsQ0FBQTtBQUFBLFNBQUEsd0JBQUEsQ0FBQSxFQUFBLENBQUEsU0FBQSxDQUFBLElBQUEsQ0FBQSxJQUFBLENBQUEsQ0FBQSxVQUFBLFNBQUEsQ0FBQSxlQUFBLENBQUEsdUJBQUEsQ0FBQSx5QkFBQSxDQUFBLFdBQUEsT0FBQSxFQUFBLENBQUEsUUFBQSxDQUFBLEdBQUEsd0JBQUEsQ0FBQSxDQUFBLE9BQUEsQ0FBQSxJQUFBLENBQUEsQ0FBQSxHQUFBLENBQUEsQ0FBQSxVQUFBLENBQUEsQ0FBQSxHQUFBLENBQUEsQ0FBQSxPQUFBLENBQUEsS0FBQSxTQUFBLFVBQUEsQ0FBQSxHQUFBLE1BQUEsQ0FBQSxjQUFBLElBQUEsTUFBQSxDQUFBLHdCQUFBLFdBQUEsQ0FBQSxJQUFBLENBQUEsb0JBQUEsQ0FBQSxJQUFBLE1BQUEsQ0FBQSxTQUFBLENBQUEsY0FBQSxDQUFBLElBQUEsQ0FBQSxDQUFBLEVBQUEsQ0FBQSxTQUFBLENBQUEsR0FBQSxDQUFBLEdBQUEsTUFBQSxDQUFBLHdCQUFBLENBQUEsQ0FBQSxFQUFBLENBQUEsVUFBQSxDQUFBLEtBQUEsQ0FBQSxDQUFBLEdBQUEsSUFBQSxDQUFBLENBQUEsR0FBQSxJQUFBLE1BQUEsQ0FBQSxjQUFBLENBQUEsQ0FB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LENBQUMsTUFBVCxFQUFBO0lBQ0UsT0FBTyxDQUFDLEtBQVIsQ0FBYyxpQ0FBZCxFQUFpRCxLQUFLLENBQUMsS0FBSyxDQUFDLEtBQTdELEVBQW9FLEtBQXBFLENBQUE7SUFDQSxPQUFPLEtBRlQ7R0FBQSxNQUFBO0lBSUUsT0FBTyxDQUFDLEdBQVIsQ0FBWSxjQUFaLEVBQTRCO01BQUUsSUFBRjtNQUFRO0lBQVIsQ0FBNUIsQ0FKRjs7RUFNQSxHQUFBLENBQUksSUFBSixFQUFVLEtBQVYsRUFBaUIsU0FBakIsQ0FBQTtFQUNBLElBQUcsS0FBSyxDQUFDLE1BQVQsRUFBQTtJQUNFLE9BQU8sQ0FBQyxLQUFSLENBQWMseUNBQWQsRUFBeUQsS0FBSyxDQUFDLEtBQUssQ0FBQyxLQUFyRSxFQUE0RSxLQUE1RSxDQUFBO0lBQ0EsT0FBTyxLQUZUO0dBQUEsTUFBQTtJQUlFLE9BQU8sQ0FBQyxHQUFSLENBQVksd0JBQVosRUFBc0M7TUFBRTtJQUFGLENBQXRDLENBSkY7O0VBTUEsSUFBQSxDQUFLLElBQUwsRUFBVyxLQUFYLEVBQWtCLFNBQWxCLENBQUE7RUFDQSxJQUFHLEtBQUssQ0FBQyxNQUFULEVBQUE7SUFDRSxPQUFPLENBQUMsS0FBUixDQUFjLHlDQUFkLEVBQXlELEtBQUssQ0FBQyxLQUFLLENBQUMsS0FBckUsRUFBNEUsS0FBNUUsQ0FBQTtJQUNBLE9BQU8sS0FGVDtHQUFBLE1BQUE7SUFJRSxPQUFPLENBQUMsR0FBUixDQUFZLHFCQUFaLEVBQW1DO01BQUU7SUFBRixDQUFuQyxDQUpGOztTQU1BLEtBQUE7QUEvQk8sQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIFR5cGUgZnJvbSBcIkBkYXNoa2l0ZS9qb3kvdHlwZVwiXG5pbXBvcnQgeyBuZWdhdGUgfSBmcm9tIFwiQGRhc2hraXRlL2pveS9wcmVkaWNhdGVcIlxuaW1wb3J0IHsgZ2VuZXJpYyB9IGZyb20gXCJAZGFzaGtpdGUvam95L2dlbmVyaWNcIlxuaW1wb3J0IHsgR3JhcGgsIFRhbG9zIH0gZnJvbSBcIi4uL2NvbnRhaW5lcnNcIlxuaW1wb3J0ICogYXMgRXJyb3JzIGZyb20gXCIuLi9jb250YWluZXJzL2Vycm9yc1wiXG5cblxubWF0Y2hWZXJ0ZXggPSAoIGdyYXBoLCB0YWxvcyApIC0+XG4gIHZlcnRleCA9IGdyYXBoLmdldCB0YWxvc1xuICBpZiAhdmVydGV4P1xuICAgIHRhbG9zLnRocm93IEVycm9ycy5JbnZhbGlkU3RhdGUuY3JlYXRlIFwidGFsb3Mgc3RhdGUgaXNcbiAgICAgIG5vdCBpbiBncmFwaFwiXG4gIHZlcnRleFxuXG5tYXRjaEVkZ2UgPSAoIHZlcnRleCwgdGFsb3MsIHRyYW5zZm9ybSApIC0+XG4gIGZvciBlZGdlIGluIHZlcnRleC5lZGdlc1xuICAgIGlmICggZWRnZS5hY2NlcHQgdGFsb3MsIHRyYW5zZm9ybSApID09IHRydWVcbiAgICAgIHJldHVybiBlZGdlXG4gIHRhbG9zLnRocm93IEVycm9ycy5NaXNzaW5nVHJhbnNpdGlvbi5jcmVhdGUgXCJubyBlZGdlIG1hdGNoZXMgdHJhbnNmb3JtXCJcblxucnVuID0gKCBlZGdlLCB0YWxvcywgdHJhbnNmb3JtICkgLT5cbiAgaWYgZWRnZS5ydW4/XG4gICAgdHJ5XG4gICAgICBlZGdlLnJ1biB0YWxvcywgdHJhbnNmb3JtXG4gICAgY2F0Y2ggZXJyb3JcbiAgICAgIHRhbG9zLnRocm93IEVycm9ycy5GYWlsZWRSdW4uY3JlYXRlIGVycm9yLCBcbiAgICAgICAgXCJlbmNvdW50ZXJlZCBhbiBlcnJvciB3aGlsZSBydW5uaW5nIGVkZ2UgZnVuY3Rpb25cIlxuXG5tb3ZlID0gKCBlZGdlLCB0YWxvcywgdHJhbnNmb3JtICkgLT5cbiAgdHJ5XG4gICAgZWRnZS5tb3ZlIHRhbG9zLCB0cmFuc2Zvcm1cbiAgY2F0Y2ggZXJyb3JcbiAgICB0YWxvcy50aHJvdyBFcnJvcnMuRmFpbGVkTW92ZS5jcmVhdGUgZXJyb3IsIFxuICAgICAgXCJlbmNvdW50ZXJlZCBhbiBlcnJvciB3aGlsZSBtb3Zpbmcgc3RhdGVzXCJcblxuXG5zdGVwID0gZ2VuZXJpYyBcbiAgbmFtZTogXCJzdGVwIHRhbG9zXCJcbiAgZGVmYXVsdDogKCBhcmdzLi4uICkgLT4gXG4gICAgdGhyb3cgbmV3IEVycm9yIFwic3RlcDogaW5wdXQgaXMgbWFsZm9ybWVkICN7SlNPTi5zdHJpbmdpZnkgYXJnc31cIlxuXG5nZW5lcmljIHN0ZXAsIEdyYXBoLmlzVHlwZSwgVGFsb3MuaXNUeXBlLCBUeXBlLmlzQW55LCAoIGdyYXBoLCB0YWxvcywgdHJhbnNmb3JtICkgLT5cbiAgX3N0ZXAgZ3JhcGgsIHRhbG9zLCB0cmFuc2Zvcm1cblxuZ2VuZXJpYyBzdGVwLCBHcmFwaC5pc1R5cGUsICggbmVnYXRlIFRhbG9zLmlzVHlwZSApLCAoIGdyYXBoLCB0cmFuc2Zvcm0gKSAtPlxuICBzdGVwIGdyYXBoLCBUYWxvcy5jcmVhdGUoKSwgdHJhbnNmb3JtXG5cblxuX3N0ZXAgPSAoIGdyYXBoLCB0YWxvcywgdHJhbnNmb3JtICkgLT5cbiAgdmVydGV4ID0gbWF0Y2hWZXJ0ZXggZ3JhcGgsIHRhbG9zXG4gIHJldHVybiB0YWxvcyBpZiB0YWxvcy5oYWx0ZWRcblxuICBlZGdlID0gbWF0Y2hFZGdlIHZlcnRleCwgdGFsb3MsIHRyYW5zZm9ybVxuICByZXR1cm4gdGFsb3MgaWYgdGFsb3MuaGFsdGVkXG5cbiAgcnVuIGVkZ2UsIHRhbG9zLCB0cmFuc2Zvcm1cbiAgcmV0dXJuIHRhbG9zIGlmIHRhbG9zLmhhbHRlZFxuXG4gIG1vdmUgZWRnZSwgdGFsb3MsIHRyYW5zZm9ybVxuICB0YWxvc1xuXG5cbmRlYnVnID0gZ2VuZXJpYyBcbiAgbmFtZTogXCJkZWJ1ZyBzdGVwIHRhbG9zXCJcbiAgZGVmYXVsdDogKCBhcmdzLi4uICkgLT4gXG4gICAgdGhyb3cgbmV3IEVycm9yIFwiZGVidWcgc3RlcDogaW5wdXQgaXMgbWFsZm9ybWVkICN7SlNPTi5zdHJpbmdpZnkgYXJnc31cIlxuXG5nZW5lcmljIGRlYnVnLCBHcmFwaC5pc1R5cGUsIFRhbG9zLmlzVHlwZSwgVHlwZS5pc0FueSwgKCBncmFwaCwgdGFsb3MsIHRyYW5zZm9ybSApIC0+XG4gIF9kZWJ1ZyBncmFwaCwgdGFsb3MsIHRyYW5zZm9ybVxuXG5nZW5lcmljIGRlYnVnLCBHcmFwaC5pc1R5cGUsICggbmVnYXRlIFRhbG9zLmlzVHlwZSApLCAoIGdyYXBoLCB0cmFuc2Zvcm0gKSAtPlxuICBfZGVidWcgZ3JhcGgsIFRhbG9zLmNyZWF0ZSgpLCB0cmFuc2Zvcm1cblxuXG5fZGVidWcgPSAoIGdyYXBoLCB0YWxvcywgdHJhbnNmb3JtICkgLT5cbiAgY29uc29sZS5sb2cgXCJzdGFydGluZyBzdGVwXCIsIHsgZ3JhcGgsIHRhbG9zLCB0cmFuc2Zvcm0gfVxuXG4gIHZlcnRleCA9IG1hdGNoVmVydGV4IGdyYXBoLCB0YWxvc1xuICBpZiB0YWxvcy5oYWx0ZWRcbiAgICBjb25zb2xlLmVycm9yIFwiZW5jb3VudGVyZWQgZXJyb3IgbWF0Y2hpbmcgdmVydGV4XCIsIHRhbG9zLmVycm9yLmVycm9yLCB0YWxvc1xuICAgIHJldHVybiB0YWxvc1xuICBlbHNlXG4gICAgY29uc29sZS5sb2cgXCJ2ZXJ0ZXggbWF0Y2hlZFwiLCB7IHZlcnRleCwgdGFsb3MgfVxuICBcbiAgZWRnZSA9IG1hdGNoRWRnZSB2ZXJ0ZXgsIHRhbG9zLCB0cmFuc2Zvcm1cbiAgaWYgdGFsb3MuaGFsdGVkXG4gICAgY29uc29sZS5lcnJvciBcImVuY291bnRlcmVkIGVycm9yIG1hdGNoaW5nIGVkZ2VcIiwgdGFsb3MuZXJyb3IuZXJyb3IsIHRhbG9zXG4gICAgcmV0dXJuIHRhbG9zXG4gIGVsc2VcbiAgICBjb25zb2xlLmxvZyBcImVkZ2UgbWF0Y2hlZFwiLCB7IGVkZ2UsIHRhbG9zIH1cblxuICBydW4gZWRnZSwgdGFsb3MsIHRyYW5zZm9ybVxuICBpZiB0YWxvcy5oYWx0ZWRcbiAgICBjb25zb2xlLmVycm9yIFwiZW5jb3VudGVyZWQgZXJyb3IgcnVubmluZyBlZGdlIGZ1bmN0aW9uXCIsIHRhbG9zLmVycm9yLmVycm9yLCB0YWxvc1xuICAgIHJldHVybiB0YWxvc1xuICBlbHNlXG4gICAgY29uc29sZS5sb2cgXCJlZGdlIGZ1bmN0aW9uIGNvbXBsZXRlXCIsIHsgdGFsb3MgfVxuXG4gIG1vdmUgZWRnZSwgdGFsb3MsIHRyYW5zZm9ybVxuICBpZiB0YWxvcy5oYWx0ZWRcbiAgICBjb25zb2xlLmVycm9yIFwiZW5jb3VudGVyZWQgZXJyb3IgcnVubmluZyBtb3ZlIGZ1bmN0aW9uXCIsIHRhbG9zLmVycm9yLmVycm9yLCB0YWxvc1xuICAgIHJldHVybiB0YWxvc1xuICBlbHNlXG4gICAgY29uc29sZS5sb2cgXCJ0YWxvcyBtb3ZlIGNvbXBsZXRlXCIsIHsgdGFsb3MgfVxuXG4gIHRhbG9zXG5cblxuZXhwb3J0IHtcbiAgc3RlcFxuICBkZWJ1Z1xufSJdLCJzb3VyY2VSb290IjoiIn0=
//# sourceURL=src/strict/sync.coffee